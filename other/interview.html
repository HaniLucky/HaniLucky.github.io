<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>常见面试题 | 博客</title>
    <meta name="description" content="胡良俊的博客">
    
    
    <link rel="preload" href="/assets/css/0.styles.3e51a216.css" as="style"><link rel="preload" href="/assets/js/app.4d7a2287.js" as="script"><link rel="preload" href="/assets/js/2.5233829b.js" as="script"><link rel="preload" href="/assets/js/19.3e146ffc.js" as="script"><link rel="prefetch" href="/assets/js/10.6da46d03.js"><link rel="prefetch" href="/assets/js/11.9f54b1f7.js"><link rel="prefetch" href="/assets/js/12.8589af30.js"><link rel="prefetch" href="/assets/js/13.a1abab67.js"><link rel="prefetch" href="/assets/js/14.1af94adf.js"><link rel="prefetch" href="/assets/js/15.423ccb51.js"><link rel="prefetch" href="/assets/js/16.86901ab9.js"><link rel="prefetch" href="/assets/js/17.c2ca1438.js"><link rel="prefetch" href="/assets/js/18.c8b66a94.js"><link rel="prefetch" href="/assets/js/20.a9ef22f2.js"><link rel="prefetch" href="/assets/js/21.d61ec449.js"><link rel="prefetch" href="/assets/js/22.ae6cad30.js"><link rel="prefetch" href="/assets/js/23.8cfadf5b.js"><link rel="prefetch" href="/assets/js/24.17e855d4.js"><link rel="prefetch" href="/assets/js/3.9d5e40bb.js"><link rel="prefetch" href="/assets/js/4.110d3bf1.js"><link rel="prefetch" href="/assets/js/5.75270d6c.js"><link rel="prefetch" href="/assets/js/6.ef8ffed8.js"><link rel="prefetch" href="/assets/js/7.f4ea738c.js"><link rel="prefetch" href="/assets/js/8.511a508c.js"><link rel="prefetch" href="/assets/js/9.6bf6e995.js">
    <link rel="stylesheet" href="/assets/css/0.styles.3e51a216.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java 基础菜单" class="dropdown-title"><span class="title">Java基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/base/collection.html" class="nav-link">集合</a></li><li class="dropdown-item"><!----> <a href="/base/thread.html" class="nav-link">多线程</a></li><li class="dropdown-item"><!----> <a href="/base/jvm.html" class="nav-link">JVM</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架 Menu" class="dropdown-title"><span class="title">框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frame/srping.html" class="nav-link">srping</a></li><li class="dropdown-item"><!----> <a href="/frame/springMvc.html" class="nav-link">springMvc</a></li><li class="dropdown-item"><!----> <a href="/frame/mybatis.html" class="nav-link">mybatis</a></li><li class="dropdown-item"><!----> <a href="/frame/springboot.html" class="nav-link">springboot</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库 Menu" class="dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/db/mysql.html" class="nav-link">mysql</a></li><li class="dropdown-item"><!----> <a href="/db/oracle.html" class="nav-link">oracle</a></li><li class="dropdown-item"><!----> <a href="/db/postgreSql.html" class="nav-link">postgrlsql</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他 Menu" class="dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/other/redis.html" class="nav-link">redis</a></li><li class="dropdown-item"><!----> <a href="/other/nginx.html" class="nav-link">nginx</a></li><li class="dropdown-item"><!----> <a href="/other/interview.html" class="nav-link router-link-exact-active router-link-active">面试常见问题</a></li><li class="dropdown-item"><!----> <a href="/other/codes.html" class="nav-link">代码段</a></li></ul></div></div><div class="nav-item"><a href="/share.html" class="nav-link">分享</a></div><div class="nav-item"><a href="https://github.com/HaniLucky" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java 基础菜单" class="dropdown-title"><span class="title">Java基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/base/collection.html" class="nav-link">集合</a></li><li class="dropdown-item"><!----> <a href="/base/thread.html" class="nav-link">多线程</a></li><li class="dropdown-item"><!----> <a href="/base/jvm.html" class="nav-link">JVM</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架 Menu" class="dropdown-title"><span class="title">框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frame/srping.html" class="nav-link">srping</a></li><li class="dropdown-item"><!----> <a href="/frame/springMvc.html" class="nav-link">springMvc</a></li><li class="dropdown-item"><!----> <a href="/frame/mybatis.html" class="nav-link">mybatis</a></li><li class="dropdown-item"><!----> <a href="/frame/springboot.html" class="nav-link">springboot</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库 Menu" class="dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/db/mysql.html" class="nav-link">mysql</a></li><li class="dropdown-item"><!----> <a href="/db/oracle.html" class="nav-link">oracle</a></li><li class="dropdown-item"><!----> <a href="/db/postgreSql.html" class="nav-link">postgrlsql</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他 Menu" class="dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/other/redis.html" class="nav-link">redis</a></li><li class="dropdown-item"><!----> <a href="/other/nginx.html" class="nav-link">nginx</a></li><li class="dropdown-item"><!----> <a href="/other/interview.html" class="nav-link router-link-exact-active router-link-active">面试常见问题</a></li><li class="dropdown-item"><!----> <a href="/other/codes.html" class="nav-link">代码段</a></li></ul></div></div><div class="nav-item"><a href="/share.html" class="nav-link">分享</a></div><div class="nav-item"><a href="https://github.com/HaniLucky" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>常见面试题</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/other/interview.html#分布式如何保证数据一致性" class="sidebar-link">分布式如何保证数据一致性</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/other/interview.html#分布式锁的实现方式" class="sidebar-link">分布式锁的实现方式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/other/interview.html#为什么要使用分布式锁" class="sidebar-link">为什么要使用分布式锁</a></li><li class="sidebar-sub-header"><a href="/other/interview.html#实现方式" class="sidebar-link">实现方式</a></li></ul></li><li><a href="/other/interview.html#多线程的创建方式" class="sidebar-link">多线程的创建方式</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/other/interview.html#线程池如何设置" class="sidebar-link">线程池如何设置</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/other/interview.html#wait-和sleep-的区别" class="sidebar-link">wait()和sleep()的区别</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/other/interview.html#集合的分类" class="sidebar-link">集合的分类</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/other/interview.html#list" class="sidebar-link">List</a></li><li class="sidebar-sub-header"><a href="/other/interview.html#set" class="sidebar-link">Set</a></li><li class="sidebar-sub-header"><a href="/other/interview.html#map" class="sidebar-link">Map</a></li></ul></li><li><a href="/other/interview.html#arraylist扩容机制" class="sidebar-link">ArrayList扩容机制</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/other/interview.html#hashmap和hashtable的初始化和扩容" class="sidebar-link">HashMap和HashTable的初始化和扩容</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/other/interview.html#hahsmap和hashtable的区别" class="sidebar-link">HahsMap和HashTable的区别</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/other/interview.html#springboot有哪些配置" class="sidebar-link">springboot有哪些配置</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/other/interview.html#ajax" class="sidebar-link">ajax</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/other/interview.html#ngixn如何应对高并发" class="sidebar-link">ngixn如何应对高并发</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/other/interview.html#springmvc一个请求的执行过程" class="sidebar-link">springmvc一个请求的执行过程</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/other/interview.html#mq的使用场景" class="sidebar-link">MQ的使用场景</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/other/interview.html#mq消费方失败如何保证数据一致" class="sidebar-link">MQ消费方失败如何保证数据一致</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/other/interview.html#简诉浏览器一个url请求是一个怎样的过程" class="sidebar-link">简诉浏览器一个url请求是一个怎样的过程</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/other/interview.html#redis的数据结构" class="sidebar-link">Redis的数据结构</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/other/interview.html#redis的持久化方式" class="sidebar-link">Redis的持久化方式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/other/interview.html#rdb" class="sidebar-link">RDB</a></li><li class="sidebar-sub-header"><a href="/other/interview.html#aof" class="sidebar-link">AOF</a></li></ul></li><li><a href="/other/interview.html#redis使用过程中会遇到的问题" class="sidebar-link">Redis使用过程中会遇到的问题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/other/interview.html#一句话总结问题及方案" class="sidebar-link">一句话总结问题及方案</a></li></ul></li><li><a href="/other/interview.html#数据库设计" class="sidebar-link">数据库设计</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/other/interview.html#索引" class="sidebar-link">索引</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/other/interview.html#索引的分类" class="sidebar-link">索引的分类</a></li><li class="sidebar-sub-header"><a href="/other/interview.html#索引的结构" class="sidebar-link">索引的结构</a></li><li class="sidebar-sub-header"><a href="/other/interview.html#创建索引的方式" class="sidebar-link">创建索引的方式</a></li><li class="sidebar-sub-header"><a href="/other/interview.html#索引的优缺点" class="sidebar-link">索引的优缺点</a></li><li class="sidebar-sub-header"><a href="/other/interview.html#什么样的字段适合创建索引" class="sidebar-link">什么样的字段适合创建索引</a></li><li class="sidebar-sub-header"><a href="/other/interview.html#什么情况创建索引" class="sidebar-link">什么情况创建索引</a></li></ul></li><li><a href="/other/interview.html#事务" class="sidebar-link">事务</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/other/interview.html#事务的特性" class="sidebar-link">事务的特性</a></li><li class="sidebar-sub-header"><a href="/other/interview.html#事务的隔离级别" class="sidebar-link">事务的隔离级别</a></li><li class="sidebar-sub-header"><a href="/other/interview.html#事务并发引发的问题" class="sidebar-link">事务并发引发的问题</a></li></ul></li><li><a href="/other/interview.html#数据库优化" class="sidebar-link">数据库优化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/other/interview.html#为什么要优化" class="sidebar-link">为什么要优化</a></li><li class="sidebar-sub-header"><a href="/other/interview.html#可优化的点" class="sidebar-link">可优化的点</a></li></ul></li><li><a href="/other/interview.html#数据库相关参考" class="sidebar-link">数据库相关参考</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="常见面试题"><a href="#常见面试题" class="header-anchor">#</a> 常见面试题</h1> <h2 id="分布式如何保证数据一致性"><a href="#分布式如何保证数据一致性" class="header-anchor">#</a> 分布式如何保证数据一致性</h2> <h2 id="分布式锁的实现方式"><a href="#分布式锁的实现方式" class="header-anchor">#</a> 分布式锁的实现方式</h2> <h3 id="为什么要使用分布式锁"><a href="#为什么要使用分布式锁" class="header-anchor">#</a> 为什么要使用分布式锁</h3> <p>需要对某条数据进行多线程同步访问的时候</p> <h3 id="实现方式"><a href="#实现方式" class="header-anchor">#</a> 实现方式</h3> <ul><li>redis</li> <li>Zookeerper</li> <li>数据库version或者时间戳<br> <a href="https://blog.csdn.net/wuzhiwei549/article/details/80692278" target="_blank" rel="noopener noreferrer">分布式锁的实现<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><br> <a href="https://www.cnblogs.com/linjiqin/p/8003838.html" target="_blank" rel="noopener noreferrer">redis锁的正确实现方式<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h2 id="多线程的创建方式"><a href="#多线程的创建方式" class="header-anchor">#</a> 多线程的创建方式</h2> <ol><li>继承Thread类</li> <li>实现Runable接口</li> <li>使用Canable创建</li> <li>使用线程池</li></ol> <blockquote><p>常用的线程池<br>
newCachedThreadPool<br>
newFixedThreadPool<br>
newSingleThreadExecutor<br>
newScheduleThreadPool</p></blockquote> <h2 id="线程池如何设置"><a href="#线程池如何设置" class="header-anchor">#</a> 线程池如何设置</h2> <div class="language-java line-numbers-mode"><pre class="language-java"><code> <span class="token comment">// 线程池 线程MAX数量 推荐使用cpu数量*2</span>
 <span class="token comment">// CPU密集型任务 一般配置线程数=CPU总核心数+1    (+1是为了利用等待空闲)</span>
 <span class="token comment">// IO密集型任务  一般配置线程数=CPU总核心数 * 2 +1</span>
 <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Runtime</span><span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">availableProcessors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="wait-和sleep-的区别"><a href="#wait-和sleep-的区别" class="header-anchor">#</a> wait()和sleep()的区别</h2> <ul><li>共同点:
他们都是在多线程环境下,都可以在调用处指定阻塞指定的毫秒值.</li> <li>不同点:</li></ul> <ol><li>wait()睡眠时,释放对象锁;sleep()睡眠时,保持对象锁,仍然占有该锁</li> <li>wait是Object的方法,sleep是Thread类的方法</li> <li>wait,notify,notityAll只能在同步控制方法和同步控制块中使用,而sleep可以在任何地方</li> <li>sleep不需要被唤醒（休眠之后推出阻塞），但是wait需要（不指定时间需要被别人中断</li></ol> <h2 id="集合的分类"><a href="#集合的分类" class="header-anchor">#</a> 集合的分类</h2> <h3 id="list"><a href="#list" class="header-anchor">#</a> List</h3> <blockquote><p>List 有序(元素存入集合和取出的顺序一致,元素有索引,元素可以重复)</p></blockquote> <ol><li>ArrayList：底层数据结构是数组，查询快，增删慢，线程不安全，效率高，可以存储重复元素</li> <li>LinkedList 底层数据结构是链表，查询慢，增删快，线程不安全，效率高，可以存储重复元素</li> <li>Vector:底层数据结构是数组，查询快，增删慢，线程安全，效率低，可以存储重复元素</li></ol> <h3 id="set"><a href="#set" class="header-anchor">#</a> Set</h3> <blockquote><p>无序(元素存入集合和取出的顺序不一致,不可以存储重复的元素.必须保证元素唯一性)</p></blockquote> <ol><li>HashSet:底层是hash表 线程不同步 无序 高效</li> <li>LinkHashSet: 有序 hashSet的子类</li> <li>TreeSet:对Set集合中的元素进行指定的顺序排序.不同步.TreeSet底层是二叉树</li></ol> <h3 id="map"><a href="#map" class="header-anchor">#</a> Map</h3> <ol><li>HashMap:底层是hash表结构,线程是不同步的,可以存储null键null值.</li> <li>HashTable:底层是hash表接口,线程是同步的.不可以存储null键null值.</li> <li>TreeMap:底层是二叉树结构,可以对map中指定的键进行排序.</li></ol> <h2 id="arraylist扩容机制"><a href="#arraylist扩容机制" class="header-anchor">#</a> ArrayList扩容机制</h2> <p>初始长度10,扩容每次是上次的1.5倍</p> <h2 id="hashmap和hashtable的初始化和扩容"><a href="#hashmap和hashtable的初始化和扩容" class="header-anchor">#</a> HashMap和HashTable的初始化和扩容</h2> <ul><li>HashMap 的初始长度是16,扩容是2倍</li> <li>HashTable 初始长度是11,扩容是2n+1</li></ul> <h2 id="hahsmap和hashtable的区别"><a href="#hahsmap和hashtable的区别" class="header-anchor">#</a> HahsMap和HashTable的区别</h2> <ol><li>HahsMap是线程不安全,效率高.HashTable是线程安全的,效率低</li> <li>HahsMap支持null键null值,HashTable不支持null键null值</li> <li>HashMap的初始长度是16,扩容是2倍;HashTable初始长度是11,扩容是2n+1</li></ol> <h4 id="hashmap-put一个元素的过程"><a href="#hashmap-put一个元素的过程" class="header-anchor">#</a> HashMap put一个元素的过程</h4> <blockquote><p>todo</p></blockquote> <h4 id="如果我想使用hashmap还要线程安全怎么处理"><a href="#如果我想使用hashmap还要线程安全怎么处理" class="header-anchor">#</a> 如果我想使用hashMap还要线程安全怎么处理</h4> <ol><li>concurrent并发包下的ConcurrentHashMap。  效率和hashTable差不多 对象锁,每次都去获取这个对象锁</li> <li>Collections.synchronizedMap(new Hashtable&lt;String,Object&gt;());   分段锁 cas+synchronized+volatile来实现
使用的技术栈</li></ol> <h2 id="springboot有哪些配置"><a href="#springboot有哪些配置" class="header-anchor">#</a> springboot有哪些配置</h2> <h2 id="ajax"><a href="#ajax" class="header-anchor">#</a> ajax</h2> <h2 id="ngixn如何应对高并发"><a href="#ngixn如何应对高并发" class="header-anchor">#</a> ngixn如何应对高并发</h2> <blockquote><p><a href="https://blog.csdn.net/hjh15827475896/article/details/53442800" target="_blank" rel="noopener noreferrer">单机 nginx 应对高并发处理<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
加机器</p></blockquote> <h4 id="ngixn的分发机制"><a href="#ngixn的分发机制" class="header-anchor">#</a> ngixn的分发机制</h4> <p>1、轮询（默认）
每个请求按时间顺序逐一分配到不同的后端服务器，如果后端服务器down掉，能自动剔除。
2、weight
指定轮询几率，weight和访问比率成正比，用于后端服务器性能不均的情况。
3、ip_hash
每个请求按访问ip的hash结果分配，这样每个访客固定访问一个后端服务器，可以解决session的问题。
4、fair（第三方）
按后端服务器的响应时间来分配请求，响应时间短的优先分配。
5、url_hash（第三方）
按访问url的hash结果来分配请求，使每个url定向到同一个后端服务器，后端服务器为缓存时比较有效。</p> <h2 id="springmvc一个请求的执行过程"><a href="#springmvc一个请求的执行过程" class="header-anchor">#</a> springmvc一个请求的执行过程</h2> <h2 id="mq的使用场景"><a href="#mq的使用场景" class="header-anchor">#</a> MQ的使用场景</h2> <ol><li>发短信</li> <li>发邮件</li> <li>日志收集</li></ol> <h2 id="mq消费方失败如何保证数据一致"><a href="#mq消费方失败如何保证数据一致" class="header-anchor">#</a> MQ消费方失败如何保证数据一致</h2> <blockquote><p><a href="https://www.jianshu.com/p/eb571e4065ec" target="_blank" rel="noopener noreferrer">MQ消息最终一致性解决方案<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <p>todo 消费方持久化,由生产者手动执行</p> <h2 id="简诉浏览器一个url请求是一个怎样的过程"><a href="#简诉浏览器一个url请求是一个怎样的过程" class="header-anchor">#</a> 简诉浏览器一个url请求是一个怎样的过程</h2> <h2 id="redis的数据结构"><a href="#redis的数据结构" class="header-anchor">#</a> Redis的数据结构</h2> <p>String、Hash、List、Set、ZSet(有序set)</p> <h2 id="redis的持久化方式"><a href="#redis的持久化方式" class="header-anchor">#</a> Redis的持久化方式</h2> <blockquote><p>RDB
AOF</p></blockquote> <h3 id="rdb"><a href="#rdb" class="header-anchor">#</a> RDB</h3> <p>在指定时间内将内存中的数据集快照写入到磁盘</p> <ul><li>优点:</li></ul> <ol><li>只有一份rdb文件,可随时备份</li> <li>比AOF文件小,加载效率高.</li> <li>不阻塞主进程,io效率高</li></ol> <h3 id="aof"><a href="#aof" class="header-anchor">#</a> AOF</h3> <pre><code>将每一个操作以日志的形式记录在服务器,在redis启动之初读取文件来重新构建数据库,保证启动后数据库中的数据是完整的
</code></pre> <ul><li>优点:
每次改动同步数据安全性好
以append的方式追加日志,不会对旧日志文件产生影响</li></ul> <h2 id="redis使用过程中会遇到的问题"><a href="#redis使用过程中会遇到的问题" class="header-anchor">#</a> Redis使用过程中会遇到的问题</h2> <blockquote><p>缓存穿透
缓存雪崩
缓存击穿</p></blockquote> <h3 id="一句话总结问题及方案"><a href="#一句话总结问题及方案" class="header-anchor">#</a> 一句话总结问题及方案</h3> <h4 id="缓存穿透"><a href="#缓存穿透" class="header-anchor">#</a> 缓存穿透</h4> <p>问题:是指查询一个数据库一定不存在的数据.</p> <p>方案:如果从数据库查询的对象为空，也放入缓存，只是设定的缓存过期时间较短，比如设置为60秒</p> <h4 id="缓存雪崩"><a href="#缓存雪崩" class="header-anchor">#</a> 缓存雪崩</h4> <p>问题:是指在某一个时间段，缓存集中过期失效。</p> <p>方案:在同一分类中的商品，加上一个随机因子。这样能尽可能分散缓存过期时间。热门类目的商品缓存时间长一些，冷门类目的商品缓存时间短一些，也能节省缓存服务的资源。</p> <h4 id="缓存击穿"><a href="#缓存击穿" class="header-anchor">#</a> 缓存击穿</h4> <p>问题:是指一个key非常热点，在不停的扛着大并发，大并发集中对这一个点进行访问，当这个key在失效的瞬间，持续的大并发就穿破缓存，直接请求数据库，就像在一个屏障上凿开了一个洞。</p> <p>方案:让缓存永不过期。即便某些商品自己发酵成了爆款，也是直接设为永不过期就好了</p> <p>OTM
[toc]</p> <h2 id="数据库设计"><a href="#数据库设计" class="header-anchor">#</a> 数据库设计</h2> <ol><li>三大范式</li></ol> <ul><li>第一范式:表中的所有字段都是不可分解的原子值</li> <li>第二范式:在第一范式的基础上,每一列都和主键相关</li> <li>第三范式:确保每一列和主键是直接相关而不是间接相关</li></ul> <ol start="2"><li>反范式</li></ol> <ul><li>反范式化:反范式化指的是通过增加冗余或重复的数据来提高数据库的性能(例如 user_code和user_name)</li></ul> <blockquote><p>反范式化可以减少关联查询时join表的次数</p></blockquote> <h2 id="索引"><a href="#索引" class="header-anchor">#</a> 索引</h2> <h3 id="索引的分类"><a href="#索引的分类" class="header-anchor">#</a> 索引的分类</h3> <blockquote><p>普通索引、唯一索引、主键索引、联合索引、全文索引</p></blockquote> <ul><li>普通索引：最基本的索引，没有任何限制</li> <li>唯一索引：与&quot;普通索引&quot;类似，不同的就是：索引列的值必须唯一，但允许有空值。</li> <li>主键索引：它 是一种特殊的唯一索引，不允许有空值。</li> <li>全文索引：仅可用于 MyISAM 表，针对较大的数据，生成全文索引很耗时好空间。</li> <li>组合索引：为了更多的提高mysql效率可建立组合索引，遵循”最左前缀“原则。创建复合索引时应该将最常用（频率）作限制条件的列放在最左边，依次递减。</li></ul> <h3 id="索引的结构"><a href="#索引的结构" class="header-anchor">#</a> 索引的结构</h3> <p>b+tree索引、hash索引
b+tree是使用最频繁的索引数据结构,b+tree的速度比不上hash,但b+tree很适合做排序操作</p> <h3 id="创建索引的方式"><a href="#创建索引的方式" class="header-anchor">#</a> 创建索引的方式</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>   普通索引
        ALTER TABLE `table_name` ADD INDEX index_name ( `column` )
    唯一索引
        ALTER TABLE `table_name` ADD UNIQUE ( `column` )
    主键索引
        ALTER TABLE `table_name` ADD PRIMARY KEY ( `column` )
    全文索引
        ALTER TABLE `table_name` ADD FULLTEXT ( `column`)
    多列索引
        ALTER TABLE `table_name` ADD INDEX index_name ( `column1`, `column2`, `column3` )
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="索引的优缺点"><a href="#索引的优缺点" class="header-anchor">#</a> 索引的优缺点</h3> <ul><li>优点</li></ul> <ol><li>通过创建唯一性索引，可以保证数据库表中每一行数据的唯一性。</li> <li>可以大大加快 数据的检索速度，这也是创建索引的最主要的原因。</li> <li>可以加速表和表之间的连接，特别是在实现数据的参考完整性方面特别有意义。</li> <li>在使用分组和排序子句进行数据检索时，同样可以显著减少查询中分组和排序的时间。</li> <li>通过使用索引，可以在查询的过程中，使用优化隐藏器，提高系统的性能。</li></ol> <ul><li>缺点</li></ul> <ol><li>创建索引和维护索引要耗费时间，这种时间随着数据量的增加而增加。</li> <li>索引需要占物理空间，除了数据表占数据空间之外，每一个索引还要占一定的物理空间。如果要建立聚簇索引，那么需要的空间就会更大。</li> <li>当对表中的数据进行增加、删除和修改的时候，索引也要动态的维护，这样就降低了数据的维护速度。
索引是建立在数据库表中的某些列的上面。因此，在创建索引的时候，应该仔细考虑在哪些列上可以创建索引，在哪些列上不能创建索引。</li></ol> <h3 id="什么样的字段适合创建索引"><a href="#什么样的字段适合创建索引" class="header-anchor">#</a> 什么样的字段适合创建索引</h3> <p>一般来说，应该在这些列上创建索引，例如：在经常需要搜索的列上，可以加快搜索的速度；</p> <ol><li>在作为主键的列上，强制该列的唯一性和组织表中数据的排列结构；</li> <li>在经常用在连接的列上，这些列主要是一些外键，可以加快连接的速度；</li> <li>在经常需要根据范围进行搜索的列上创建索引，因为索引已经排序，其指定的范围是连续的；</li> <li>在经常需要排序的列上创建索引，因为索引已经排序，这样查询可以利用索引的排序，加快排序查询时间；</li> <li>在经常使用在WHERE子句中的列上面创建索引，加快条件的判断速度。</li></ol> <h3 id="什么情况创建索引"><a href="#什么情况创建索引" class="header-anchor">#</a> 什么情况创建索引</h3> <p>建立索引，一般按照select的where条件来建立，比如： select的条件是where f1 and f2，那么如果我们在字段f1或字段f2上简历索引是没有用的，只有在字段f1和f2上同时建立索引才有用等。
<strong>什么样的字段不适合创建索引:</strong>
同样，对于有些列不应该创建索引。一般来说，不应该创建索引的的这些列具有下列特点：</p> <ol><li>对于那些在查询中很少使用或者参考的列不应该创建索引。这是因为，既然这些列很少使用到，因此有索引或者无索引，并不能提高查询速度。相反，由于增加了索引，反而降低了系统的维护速度和增大了空间需求。</li> <li>对于那些只有很少数据值的列也不应该增加索引。这是因为，由于这些列的取值很少，例如人事表的性别列，在查询的结果中，结果集的数据行占了表中数据行的很大比 例，即需要在表中搜索的数据行的比例很大。增加索引，并不能明显加快检索速度。</li> <li>对于那些定义为text, image和bit数据类型的列不应该增加索引。这是因为，这些列的数据量要么相当大，要么取值很少。</li> <li>当修改性能远远大于检索性能时，不应该创建索 引。这是因为，修改性能和检索性能是互相矛盾的。当增加索引时，会提高检索性能，但是会降低修改性能。当减少索引时，会提高修改性能，降低检索性能。因此，当修改性能远远大于检索性能时，不应该创建索引。</li></ol> <h2 id="事务"><a href="#事务" class="header-anchor">#</a> 事务</h2> <h3 id="事务的特性"><a href="#事务的特性" class="header-anchor">#</a> 事务的特性</h3> <p>ACID 原子性 一致性 隔离性 持久性</p> <ul><li>原子性:事务不可分割,要么全部完成,要么全部不完成.如果在事务过程中出现错误,则全部回滚.</li> <li>一致性:事务结束前和结束后,数据库的完整性约束没有被破环.比如A向B转账,不能A扣了钱,B没有却没有收到.</li> <li>隔离性:同一时间,只允许一个事务请求同一数据,不同事务之间彼此没有任何干扰,比如A正在从一张银行卡中取钱,在A取钱结束之前,B不能向这张卡转账</li> <li>持久性:事务完成之后,事务对数据库的所有更新将被保存到数据库,不能回滚。</li></ul> <h3 id="事务的隔离级别"><a href="#事务的隔离级别" class="header-anchor">#</a> 事务的隔离级别</h3> <blockquote><p>读未提交、读已提交、可重复读、串行化</p></blockquote> <ul><li>读未提交什么都不能防止</li> <li>读已经提交可以有效防止脏读  orcal ,sql server</li> <li>可重复读可防止不可重复读,脏读  mysql默认的事务隔离级别</li> <li>串行化可防止脏读,不可重复读,幻读</li></ul> <h3 id="事务并发引发的问题"><a href="#事务并发引发的问题" class="header-anchor">#</a> 事务并发引发的问题</h3> <ul><li>脏读:一个事务读取了一个事务未提交的数据</li> <li>不可重复读:一个事务读取表中的某一行数据,多次读取结果不同</li></ul> <p>脏读和不可重复读的区别是:脏读是读取了前一事务还未提交的数据,不可重复读是重新读取了前一事务提交的数据</p> <ul><li>幻读:一个事务读取到了别的事务插入的数据,导致前后查询不一致</li></ul> <p>不可重复读和幻读的区别是:不可重复读侧重的修改,幻读侧重的是新增和删除.解决不可重复读的方法是锁住满足条件的行,解决幻读的方案是锁表</p> <blockquote><p>补充:</p></blockquote> <ol><li>串行化效率很低,读写数据都会锁住整张表</li> <li>隔离级别越高，越能保证数据的完整性和一致性，但是对并发性能的影响也越大，鱼和熊掌不可兼得啊。对于多数应用程序，可以优先考虑把数据库系统的隔离级别设为读已提交，它能够避免脏读取，而且具有较好的并发性能。尽管它会导致不可重复读、幻读这些并发问题，在可能出现这类问题的个别场合，可以由应用程序采用悲观锁或乐观锁来控制。</li></ol> <h2 id="数据库优化"><a href="#数据库优化" class="header-anchor">#</a> 数据库优化</h2> <h3 id="为什么要优化"><a href="#为什么要优化" class="header-anchor">#</a> 为什么要优化</h3> <ul><li>要优化的原因,查询慢</li> <li>查询慢的原因,进行了全表扫描</li></ul> <h3 id="可优化的点"><a href="#可优化的点" class="header-anchor">#</a> 可优化的点</h3> <ul><li>合理的搜索引擎</li> <li>表结构设计合理(范式和反范式)</li> <li>查询的优化</li> <li>架构级别的优化</li></ul> <ol><li>合理的搜索引擎</li></ol> <ul><li>MYISAM(不支持事务，也不支持外键，尤其是访问速度快，对事务完整性没有要求或者以SELECT、INSERT为主的应用基本都可以使用这个引擎来创建表)</li> <li>Memory</li> <li>InnoDB(5.5默认)(InnoDB存储引擎提供了具有提交、回滚和崩溃恢复能力的事务安全。但是对比MyISAM的存储引擎，InnoDB写的处理效率差一些并且会占用更多的磁盘空间以保留数据和索引)</li> <li>Archive
<a href="https://blog.csdn.net/zhangyuan19880606/article/details/51217952" target="_blank" rel="noopener noreferrer">4种mysql引擎<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <ol start="2"><li>表设计优化</li></ol> <ul><li>索引并不是越多越好,索引固然可以提高相应的select的效率,但同时也降低了insert和update的效率.因为insert和update是可能会重建索引,所以怎样建索引需要慎重考虑,视具体的情况而定.
<em>一个表的索引最好不要超过6个,太多的话要慎重考虑</em></li> <li>尽量使用数字型字段,若只包含数值信息的字尽量不要设计成字符型,这会降低查询和连接的效率,并增加存储开销.这是因为引擎在处理查询和连接时会逐个比较字符串中的每个字符,而对于数字型而言比较一次就行</li> <li>对于非定长字符类型的字段,使用varchar而不是使用char
varchar的长度是可变的,char的长度是固定的.例如char(10)的长度是10 如果存入'abcd'长度还是10,会默认给补充空格,</li> <li>表结构的拆分(几种常见的表拆法)
①.核心字段一张表,非核心字段一张表
②.大字段一张表,text和超长的vhrchar单独一张表
③.常用字段和不常用字段的拆开</li> <li>字段类型优先级  整型 &gt; date,time &gt; enum, char &gt; varchar &gt; blob</li> <li>够用就行，不要慷慨(如 smallint,varcahr(N))</li> <li>尽量避免null</li></ul> <ol start="3"><li>查询优化</li></ol> <blockquote><p>对查询进行优化,避免全表扫描</p></blockquote> <ul><li>在wherer和order by的列上添加索引.</li> <li>在where条件上避免对null的判断,否则导致搜索引擎放弃使用索引而进行全表扫描 <em>赋默认值</em></li> <li>避免在where子句中使用!=或则&lt;&gt;操作符,否则索引失效而进行全表扫描</li> <li>应避免在where字句中使用or来连接条件,否则索引失效而进行全表扫描
<em>使用union all代替</em></li> <li>避免使用in和not in,否则会进行全表扫描
<em>对于连续的值使用between</em> <em>对于不连续的值使用 exists,not exists</em></li> <li>避免使用like</li> <li>不要对where子句中的=号左边进行运算</li> <li>不要对where子句中的字段进行函数处理</li> <li>当只查询一条数据时使用LIMIT 1</li></ul> <ol start="4"><li>系统级别的优化</li></ol> <ul><li>分库分表(mycat)
分库(纵向拆分)
分表(横向拆分)</li> <li>加缓存(redis和ES)
<a href="https://www.php.cn/redis/425065.html" target="_blank" rel="noopener noreferrer">redis和es的区别<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h2 id="数据库相关参考"><a href="#数据库相关参考" class="header-anchor">#</a> 数据库相关参考</h2> <p><a href="https://www.jianshu.com/p/08d123026438" target="_blank" rel="noopener noreferrer">三大范式<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <a href="https://www.cnblogs.com/moxiaotao/p/10120672.html" target="_blank" rel="noopener noreferrer">三大范式和反范式(解释的比较详细,推荐)<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <a href="https://blog.csdn.net/qq_38789941/article/details/83744271" target="_blank" rel="noopener noreferrer">sql优化<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <a href="https://blog.csdn.net/fd2025/article/details/80339795" target="_blank" rel="noopener noreferrer">表设计的优化(推荐)<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.4d7a2287.js" defer></script><script src="/assets/js/2.5233829b.js" defer></script><script src="/assets/js/19.3e146ffc.js" defer></script>
  </body>
</html>
